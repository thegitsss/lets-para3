<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Paralegal Invitations – Let’s-ParaConnect</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@200;400;600&family=Cormorant+Garamond:wght@300;600&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="assets/styles/paralegal-cluster.css" />
<script src="assets/scripts/utils/session.js"></script>
<script type="module" src="assets/scripts/auth.js"></script>
<style>
    .skip-link {
      position: absolute;
      left: 12px;
      top: -40px;
      background: #1a2230;
      color: #ffffff;
      padding: 8px 12px;
      border-radius: 6px;
      text-decoration: none;
      z-index: 10000;
      font-size: 14px;
    }

    .skip-link:focus {
      top: 12px;
    }

    .gold{color:#b4975a;}
:root{
  --bg:#ffffff;
  --sidebar-bg:#f5f5f5e6;
  --accent:#b6a47a;
  --navy:#102c50;
  --ink:#1a1a1a;
  --muted:#8a8a8a;
  --line:rgba(0,0,0,0.08);
  --panel:#fcfcfc;
  --sidebar-text:#1a1a1a;
  --radius:14px;
  --font-serif:'Cormorant Garamond',serif;
  --font-sans:'Sarabun',sans-serif;
  --shadow:0 14px 40px rgba(0,0,0,0.06);
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:var(--font-sans);
  font-weight:200;
  color:var(--ink);
  background:var(--bg);
  display:flex;
  height:100vh;
  overflow:hidden;
}

/* Sidebar */
.sidebar{
  width:240px;
  background:var(--sidebar-bg);
  color:var(--sidebar-text);
  display:flex;
  flex-direction:column;
  font-weight:200;
  padding:24px 16px;
  border-right:1px solid var(--line);
  position:sticky;
  top:0;
  height:100vh;
  overflow-y:auto;
}
.sidebar::before{
  content:none;
}
.logo,nav,.sidebar-footer{position:relative;z-index:2;}
.logo{
  font-family:var(--font-serif);
  font-size:1.6rem;
  font-weight:300;
  text-align:center;
  margin-bottom:36px;
}
nav{display:flex;flex-direction:column;gap:14px;}
nav a{
  text-decoration:none;
  color:var(--ink);
  font-weight:200;
  font-size:.95rem;
  padding:10px 14px;
  border-radius:var(--radius);
  transition:background .3s;
}
nav a.active,nav a:hover{background:rgba(0,0,0,0.04);}
.sidebar-link{
  display:block;
  width:100%;
  border:none;
  background:none;
  color:var(--sidebar-text);
  font-size:.95rem;
  font-family:var(--font-sans);
  font-weight:300;
  text-align:left;
  padding:10px 14px;
  border-radius:var(--radius);
  cursor:pointer;
  position:relative;
  z-index:2;
}
.sidebar-link:hover,.sidebar-link:focus{background:rgba(0,0,0,0.04);outline:none;}
.sidebar-footer{
  margin-top:auto;
  font-size:.7rem;
  color:var(--muted);
  text-align:center;
  position:relative;
}

.sidebar-toggle{
  display:none;
  align-items:center;
  justify-content:center;
  width:42px;
  height:42px;
  border-radius:12px;
  border:none;
  background:transparent;
  padding:0;
  cursor:pointer;
  position:fixed;
  top:14px;
  left:14px;
  z-index:2100;
}

.sidebar-toggle-icon{
  width:28px;
  height:28px;
  display:block;
}

.sidebar-backdrop{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.35);
  z-index:1900;
}

/* Weather widget footer */
#weatherSidebar{
  display:none;
}

/* Main */
.main{
  flex:1;
  padding:40px;
  overflow-y:auto;
  scroll-behavior:smooth;
}
header h1{
  font-family:var(--font-serif);
  font-weight:300;
  font-size:2.3rem;
  margin-bottom:.25rem;
}
header p{color:var(--muted);font-size:.95rem;margin-bottom:2rem;}
.page-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:16px;
  margin-bottom:2rem;
}
.profile-header-controls{
  display:flex;
  align-items:center;
  gap:16px;
  position:relative;
  z-index:4;
}
.notification-wrapper{position:relative;}
.notification-icon{
  width:46px;
  height:46px;
  border-radius:50%;
  border:1px solid var(--line);
  display:flex;
  justify-content:center;
  align-items:center;
  background:#fff;
  cursor:pointer;
  transition:border-color .2s ease,transform .2s ease;
  position:relative;
}
.notification-icon:hover{
  border-color:var(--accent);
  transform:translateY(-1px);
}
.notification-badge{
  position:absolute;
  top:-5px;
  right:-5px;
  width:18px;
  height:18px;
  border-radius:50%;
  background:#e63946;
  color:#fff;
  font-size:.7rem;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:600;
  display:none;
}
.notification-badge.show{display:flex;}
.user-chip{
  display:flex;
  align-items:center;
  gap:12px;
  padding:6px 14px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#fff;
  box-shadow:var(--shadow);
  text-decoration:none;
  color:inherit;
  cursor:pointer;
}
.user-chip img{
  width:44px;
  height:44px;
  border-radius:50%;
  object-fit:cover;
}
.header-cluster [data-notification-toggle][data-count]:after,
#notificationToggle[data-count]:after{
  content:attr(data-count);
  position:absolute;
  top:-4px;
  right:-4px;
  background:var(--accent);
  color:#fff;
  font-family:'Sarabun',sans-serif;
  font-weight:200;
  font-size:0.7rem;
  padding:2px 6px;
  border-radius:999px;
}
.notif-panel{
  position:absolute;
  right:0;
  top:48px;
  width:340px;
  background:#fff;
  border:1px solid var(--line);
  border-radius:14px;
  padding:0;
  z-index:2000;
  display:none;
  flex-direction:column;
  box-shadow:0 24px 48px rgba(0,0,0,0.12);
}
.notif-panel.show{display:flex;}
.notif-panel.hidden{display:none;}
.notif-header{
  font-family:'Cormorant Garamond',serif;
  font-weight:300;
  font-size:1.3rem;
  padding:14px 18px;
  border-bottom:1px solid rgba(0,0,0,0.08);
  background:#fafafa;
}
#notifList{
  max-height: 220px;
  overflow-y:auto;
}
.notif-item{
  padding:14px 18px;
  border-bottom:1px solid rgba(0,0,0,0.06);
  cursor:pointer;
  transition:background .15s ease;
}
.notif-item:last-child{border-bottom:none;}
.notif-item:hover{background:#f6f6f6;}
.notif-item.unread{
  background:#fff;
  border-left:3px solid var(--accent);
}
.notif-item.read{opacity:.75;}
.notif-title{
  font-family:'Cormorant Garamond',serif;
  font-weight:300;
  font-size:1.15rem;
  margin-bottom:2px;
  color:#1a1a1a;
}
.notif-body{
  font-family:'Sarabun',sans-serif;
  font-weight:200;
  font-size:.92rem;
  color:#444;
  line-height:1.45;
}
.notif-time{
  margin-top:4px;
  font-family:'Sarabun',sans-serif;
  font-weight:200;
  font-size:.8rem;
  color:#888;
}
.notif-empty{
  padding:18px;
  text-align:center;
  font-size:.9rem;
  color:#8a8a8a;
}
.notif-markall{
  border:none;
  border-top:1px solid rgba(0,0,0,0.08);
  background:#fafafa;
  padding:12px;
  font-family:'Sarabun',sans-serif;
  font-weight:200;
  font-size:.9rem;
  cursor:pointer;
  text-align:left;
}
.notif-markall:hover{background:#f0f0f0;}

/* Metrics */
.metrics{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:1rem;
  margin-bottom:2rem;
}
.metric{
  border:1px solid var(--line);
  border-radius:10px;
  padding:1rem;
  text-align:center;
  background:#fff;
}
.metric.pink{background:#fff;} .metric.pink p{color:#e45a84;}
.metric.blue{background:#fff;} .metric.blue p{color:#4a90e2;}
.metric.purple{background:#fff;} .metric.purple p{color:#9b59b6;}
.metric.teal{background:#fff;} .metric.teal p{color:#16a085;}
.metric.violet{background:#fff;color:var(--ink);}
.metric.violet p{color:var(--ink);}
.dashboard-grid{display:grid;grid-template-columns:2fr 1fr;gap:2rem;align-items:start;}
.chart-card{background:#fff;border:1px solid var(--line);border-radius:10px;padding:1.5rem;}
.chart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;}
.stats-cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem;}
.lower-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem;margin-top:2rem;}
.panel{background:#fff;border:1px solid var(--line);border-radius:10px;padding:1.5rem;}
.panel.new-users .search{width:100%;padding:.5rem .75rem;margin-bottom:1rem;border:1px solid var(--line);border-radius:6px;}
.user-list{list-style:none;padding:0;margin:0;} .user-list li{display:flex;justify-content:space-between;padding:.4rem 0;border-bottom:1px solid var(--line);}
.circle-progress{width:120px;height:120px;border-radius:50%;border:6px solid var(--accent);display:flex;align-items:center;justify-content:center;margin:1rem auto;font-weight:600;}
.sales-box{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;text-align:center;margin-top:1rem;}
.sales-box div strong{display:block;font-size:1.3rem;color:var(--accent);}
.sales-box div span{font-size:.85rem;color:var(--muted);}
.grid-two {display:grid;grid-template-columns:2fr 1fr;gap:1.5rem;margin-bottom:2rem;}
.escrow-summary {display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-bottom:1.5rem;}
.card {background:#fff;border:1px solid var(--line);border-radius:10px;padding:1rem;text-align:center;}
.card.highlight {background:#fff;color:var(--ink);}
.card.highlight h3,.card.highlight p{color:var(--ink);}
.quick-stats {display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:1rem;text-align:center;margin-bottom:2rem;}
.quick-stats div{background:#fff;border:1px solid var(--line);border-radius:10px;padding:.8rem;}
.quick-stats strong{display:block;color:var(--accent);font-size:1.2rem;}
.panel-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;}
.view-all{font-size:.9rem;color:var(--accent);text-decoration:none;}
tickets{width:100%;border-collapse:collapse;}
tickets th,.tickets td{padding:.75rem;border-bottom:1px solid var(--line);}
tickets th{color:var(--muted);text-align:left;}
.status.open{background:#e2fff7;color:#16a085;padding:4px 8px;border-radius:6px;font-size:.8rem;}
.details-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;z-index:1000;}
.details-content{background:#fff;border-radius:12px;max-width:800px;width:90%;padding:2rem;max-height:90vh;overflow-y:auto;position:relative;}
.details-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;}
.details-table{width:100%;border-collapse:collapse;margin-top:1rem;}
.details-table td{padding:.6rem .4rem;border-bottom:1px solid var(--line);}
.highlight-text{background:#e6fff6;color:#16a085;padding:3px 8px;border-radius:4px;}
.hidden{display:none;}
.posts-table{width:100%;border-collapse:collapse;}
.posts-table th,.posts-table td{padding:.75rem;border-bottom:1px solid var(--line);text-align:left;}
.status.pending{background:#fff4e5;color:#e67e22;padding:4px 8px;border-radius:6px;font-size:.8rem;}
.status.approved{background:#e2fff7;color:#16a085;padding:4px 8px;border-radius:6px;font-size:.8rem;}
.flagged-list{list-style:none;padding:0;margin:0;}
.flagged-list li{padding:.6rem .4rem;border-bottom:1px solid var(--line);font-size:.95rem;}
.flagged-list li:last-child{border-bottom:none;}
#section-user-management,
#section-user-management *{
  font-family:var(--font-sans);
  font-weight:200;
}
#section-user-management h1,
#section-user-management h2,
#section-user-management h3{
  font-family:var(--font-serif);
  font-weight:300;
}
.quality-bar{height:10px;background:#e8e8e8;border-radius:6px;overflow:hidden;}
.quality-fill{height:10px;background:var(--accent);border-radius:6px 0 0 6px;}
.btn.danger{background:#ffebeb;color:#c0392b;border:1px solid #f8d7da;}
.btn.danger:hover{background:#c0392b;color:#fff;}
.input-field{width:100%;padding:.6rem .8rem;margin-bottom:1rem;border:1px solid var(--line);border-radius:6px;font-family:var(--font-sans);}
.search{width:260px;padding:.5rem .75rem;border:1px solid var(--line);border-radius:6px;}
.grid-four{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-bottom:1.5rem;}
.ledger-table{width:100%;border-collapse:collapse;}
.ledger-table th,.ledger-table td{padding:.75rem;border-bottom:1px solid var(--line);text-align:left;}
.tax-summary,.payout-schedule{list-style:none;padding:0;margin:0;}
.tax-summary li,.payout-schedule li{padding:.4rem 0;border-bottom:1px solid var(--line);font-size:.95rem;}
.tax-summary strong{color:var(--ink);}
.payout-schedule li:last-child,.tax-summary li:last-child{border-bottom:none;}
.metric h3{font-family:var(--font-serif);font-weight:400;font-size:1.1rem;margin-bottom:.25rem;}
.metric p{font-size:1.6rem;color:var(--accent);font-weight:200;}

/* Panels */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(360px,1fr));gap:1.5rem;margin-bottom:2rem;}
.panel{
  border:1px solid var(--line);
  border-radius:10px;
  padding:1.25rem 1.5rem;
  background:#fff;
  transition:all .25s ease;
}
.panel:hover{border-color:var(--accent);}
.panel h2{
  font-family:var(--font-serif);
  font-weight:500;
  font-size:1.3rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  cursor:pointer;
}
.panel h2 span{font-size:1.2rem;color:var(--muted);}
.panel-content{margin-top:1rem;display:block;transition:max-height .4s ease;}
.panel.collapsed .panel-content{display:none;}
table{width:100%;border-collapse:collapse;font-size:.9rem;}
th,td{text-align:left;padding:10px 6px;border-bottom:1px solid var(--line);}
th{color:var(--muted);font-weight:200;}
.btn{border:none;border-radius:6px;padding:6px 12px;font-size:.9rem;cursor:pointer;transition:all .2s ease;}
.btn.primary{background:var(--accent);color:#fff;}
.btn.primary:hover{background:#a38e5f;}
.btn.secondary{background:#fff;border:1px solid var(--line);color:var(--ink);}
.btn.secondary:hover{border-color:var(--accent);color:var(--accent);}
.weather{display:flex;align-items:center;justify-content:space-between;}
.weather h3{font-family:var(--font-serif);font-weight:400;}
.toast{
  position:fixed;
  right:24px;
  bottom:24px;
  background:#fff;
  color:#ink;
  padding:12px 18px;
  border-radius:999px;
  border:1px solid var(--line);
  opacity:0;
  transform:translateY(20px);
  transition:opacity .2s ease,transform .2s ease;
  z-index:2000;
  font-size:.95rem;
}
.toast.show{opacity:1;transform:translateY(0);}
.toast[data-toast-type="ok"]{background:#fff;}
.toast[data-toast-type="err"]{background:#fff;}
.pending-controls{display:flex;flex-wrap:wrap;gap:.75rem;margin-bottom:1rem;align-items:flex-start;}
.pending-controls .search{flex:1;min-width:220px;}
.pending-controls select{padding:.55rem .8rem;border:1px solid var(--line);border-radius:6px;background:#fff;font-family:var(--font-sans);font-size:.95rem;}
.pending-count{color:var(--muted);font-size:.9rem;}
.pending-empty{padding:1rem;text-align:center;color:var(--muted);}
.pending-users-table td.actions{width:140px;}
.pending-users-table td.actions .btn{width:100%;}
.pending-modal-actions{display:flex;justify-content:flex-end;gap:.75rem;margin-top:1.5rem;}
#pendingUserModal .details-content{max-width:900px;}
#pendingUserModal .details-table td:first-child{width:200px;font-weight:600;}
#pendingUserModal .details-table td:last-child{white-space:pre-line;}
.section {display:none;opacity:0;transition:opacity .4s ease;}
.section.visible {display:block;opacity:1;}
nav a.active {background:rgba(0,0,0,0.04);}

.card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem;}
.lpc-card{
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:1.5rem;
  background:var(--panel);
  box-shadow:var(--shadow);
  scroll-margin-top:24px;
}
.lpc-card h3{
  font-family:var(--font-serif);
  font-weight:300;
  font-size:1.4rem;
  margin-bottom:1rem;
}
#invitationList{
  display:flex;
  flex-direction:column;
  gap:16px;
}
.invite-card{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
  border:1px solid var(--line);
  border-radius:12px;
  padding:16px 18px;
  background:#fff;
}
.invite-main{
  display:flex;
  flex-direction:column;
  gap:6px;
}
.invite-title{
  font-family:var(--font-serif);
  font-weight:300;
  font-size:1.3rem;
}
.invite-meta{
  color:var(--muted);
  font-size:.95rem;
}
.invite-actions{
  display:flex;
  gap:10px;
  flex-shrink:0;
}
.invite-actions .btn{
  padding:8px 14px;
  border-radius:999px;
  font-size:.9rem;
}
@media (max-width: 1024px){
  body{
    flex-direction:column;
    height:auto;
  }
  .sidebar{
    position:fixed;
    top:0;
    left:0;
    width:260px;
    height:100vh;
    border-right:none;
    padding-top:72px;
    transform:translateX(-110%);
    transition:transform .25s ease;
    z-index:2000;
    box-shadow:18px 0 40px rgba(0,0,0,0.18);
  }
  body.nav-open .sidebar{
    transform:translateX(0);
  }
  body.nav-open .sidebar-backdrop{
    display:block;
  }
  .sidebar-toggle{
    display:inline-flex;
  }
  .main{padding:28px 20px 60px;}
  .page-header{flex-direction:column;align-items:flex-start;}

  .main{
    max-width:100%;
    overflow-x:hidden;
  }

  img,
  svg,
  video,
  iframe,
  table{
    max-width:100%;
    height:auto;
  }

  .invite-card,
  .invite-meta,
  .notif-body,
  .notif-item{
    min-width:0;
    overflow-wrap:anywhere;
    word-break:break-word;
  }
}
@media (max-width: 720px){
  .invite-card{flex-direction:column;align-items:flex-start;}
  .invite-actions{width:100%;justify-content:flex-start;flex-wrap:wrap;}
  .notif-panel{right:auto;left:0;}
}
.lpc-card h3{font-family:var(--font-serif);font-weight:500;margin-bottom:.75rem;}
.lpc-card h4{margin-top:1rem;margin-bottom:.5rem;font-family:var(--font-serif);font-weight:500;}
.lpc-card ul{padding-left:1.1rem;line-height:1.5;}
.lpc-card img.profile-img{width:120px;height:120px;border-radius:12px;object-fit:cover;display:block;margin:0 auto 1rem;box-shadow:0 10px 30px rgba(0,0,0,0.08);}
</style>
</head>

<body>
  <a class="skip-link" href="#main">Skip to main content</a>
<button class="sidebar-toggle" id="sidebarToggle" type="button" aria-label="Open menu" aria-controls="sidebarNav" aria-expanded="false">
  <img class="sidebar-toggle-icon" src="sidebar-4.png" alt="" aria-hidden="true" />
</button>
<aside class="sidebar" id="sidebarNav">
  <div class="logo">Paralegal Panel</div>
  <nav>
    <a href="dashboard-paralegal.html" class="sideNavItem" data-target="paraProfileCard">Overview</a>
    <a href="#invitationList" class="sideNavItem active" data-target="invitationList">Invitations</a>
    <a href="dashboard-paralegal.html#paraApplications" class="sideNavItem" data-target="paraApplications">Applications</a>
    <a href="dashboard-paralegal.html#paraAssignedCases" class="sideNavItem" data-target="paraAssignedCases">Assigned Cases</a>
    <a href="profile-settings.html" class="sideNavItem" data-target="settingsPage">Settings</a>
  </nav>
  <button type="button" class="sidebar-link sideNavItem" data-target="logout" id="logoutBtn">Log Out</button>
  <div id="weatherSidebar">Stay current</div>
  <div class="sidebar-footer">© Let’s-ParaConnect 2025</div>
</aside>
<div class="sidebar-backdrop" id="sidebarBackdrop" aria-hidden="true"></div>

<main id="main" tabindex="-1" class="main">
  <header class="page-header">
    <div>
      <h1>Welcome, <span class="globalProfileName">Paralegal</span></h1>
      <p>Review invitations and respond quickly.</p>
    </div>
    <div class="header-cluster profile-header-controls" data-notification-center>
      <div class="notification-wrapper">
        <button class="notification-icon" type="button" aria-label="View notifications" data-notification-toggle id="notificationToggle">
          <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M18 8a6 6 0 10-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 01-3.46 0"></path>
          </svg>
          <span class="notification-badge" id="notificationBadge" data-notification-badge>0</span>
        </button>
        <div
          class="notification-dropdown"
          id="notificationDropdown"
          style="
            display: none;
            width: 320px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            padding: 16px;
          "
        >
          <div style="font-weight: 600; margin-bottom: 8px;">
            Notifications
          </div>

          <div id="notificationList" style="font-size: 14px; color: #555;">
            No new notifications.
          </div>
        </div>
        <div id="notificationPanel" class="notif-panel hidden" data-notification-panel>
          <div class="notif-header">Notifications</div>
          <div class="notif-body" id="notifList" data-notification-list></div>
          <div class="notif-empty" data-notification-empty>No new notifications.</div>
        </div>
      </div>
      <a class="user-chip" href="/dashboard-paralegal.html" aria-label="Go to dashboard">
        <img id="clusterAvatar" class="nav-profile-photo" src="https://via.placeholder.com/64x64.png?text=PL" alt="Profile" />
        <div>
          <strong id="clusterName">Paralegal</strong>
          <span id="clusterRole">Member</span>
        </div>
      </a>
    </div>
  </header>

  <h2 style="font-family:var(--font-serif);font-weight:300;margin-bottom:1rem;">Invitations</h2>
  <section id="invitationList" class="lpc-card"></section>
</main>

<div id="toastBanner" class="toast" role="status" aria-live="polite"></div>

<script src="assets/scripts/utils/toast.js"></script>
<script type="module" src="assets/scripts/utils/notifications.js"></script>
<script src="assets/scripts/paralegal-cluster.js"></script>
<script type="module" src="assets/scripts/paralegal-invitations.js"></script>
<script type="module">
  import { loadUserHeaderInfo } from "./assets/scripts/auth.js";
  loadUserHeaderInfo();
</script>
<script>
  (function bindOutsideNotificationDismiss() {
    const closePanels = () => {
      document.querySelectorAll('[data-notification-panel].show').forEach((panel) => {
        panel.classList.remove('show');
        panel.classList.add('hidden');
        panel.style.display = 'none';
      });
      const dropdown = document.getElementById('notificationDropdown');
      if (dropdown) dropdown.style.display = 'none';
    };

    const isInsideNotification = (event) => {
      const path = typeof event.composedPath === 'function' ? event.composedPath() : [];
      const panels = document.querySelectorAll('[data-notification-panel]');
      const toggles = document.querySelectorAll('[data-notification-toggle]');
      if (Array.from(panels).some((panel) => path.includes(panel))) return true;
      if (Array.from(toggles).some((toggle) => path.includes(toggle))) return true;
      const target = event.target && event.target.nodeType === 1 ? event.target : null;
      return !!target?.closest?.(
        '[data-notification-panel], [data-notification-toggle], .notification-dropdown, #paralegalFloatingCluster'
      );
    };

    const handleOutside = (event) => {
      if (isInsideNotification(event)) return;
      closePanels();
    };

    const clearInlineDisplay = () => {
      document.querySelectorAll('[data-notification-panel]').forEach((panel) => {
        panel.style.display = '';
      });
      const dropdown = document.getElementById('notificationDropdown');
      if (dropdown) dropdown.style.display = '';
    };

    document.querySelectorAll('[data-notification-toggle]').forEach((toggle) => {
      toggle.addEventListener('click', clearInlineDisplay);
    });

    window.addEventListener('click', handleOutside, true);
    document.addEventListener('click', handleOutside, true);

    document.addEventListener('keydown', (event) => {
      if (event.key === 'Escape') closePanels();
    });
  })();
</script>
<script>
  const sidebarToggle = document.getElementById('sidebarToggle');
  const sidebarNav = document.getElementById('sidebarNav');
  const sidebarBackdrop = document.getElementById('sidebarBackdrop');
  const closeSidebar = () => {
    document.body.classList.remove('nav-open');
    if (sidebarToggle) sidebarToggle.setAttribute('aria-expanded', 'false');
  };
  const openSidebar = () => {
    document.body.classList.add('nav-open');
    if (sidebarToggle) sidebarToggle.setAttribute('aria-expanded', 'true');
  };
  if (sidebarToggle) {
    sidebarToggle.addEventListener('click', () => {
      if (document.body.classList.contains('nav-open')) closeSidebar();
      else openSidebar();
    });
  }
  if (sidebarBackdrop) {
    sidebarBackdrop.addEventListener('click', closeSidebar);
  }
  if (sidebarNav) {
    sidebarNav.addEventListener('click', (event) => {
      if (event.target && event.target.tagName === 'A') closeSidebar();
    });
  }
  window.addEventListener('resize', () => {
    if (window.innerWidth > 960) closeSidebar();
  });
</script>
</body>
</html>
