<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#0B2A4A">
  <title>Case Workspace - Let's-ParaConnect</title>
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
  <link rel="icon" href="/favicon.ico" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="manifest" href="site.webmanifest" />
  <link rel="mask-icon" href="maskable-icon.png" color="#0B2A4A" />
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet" />
  <script src="assets/scripts/utils/session.js"></script>
  <style>
    :root {
      --font-sans: "Sarabun", sans-serif;
      --font-serif: "Cormorant Garamond", serif;

      --app-background: #f5f6f8;
      --app-rail: #ffffff;
      --app-surface: #ffffff;
      --app-surface-muted: #f0f3f7;
      --app-card: #ffffff;
      --app-border: #e1e6ee;
      --app-text: #141b24;
      --app-muted: #5d6b7a;
      --app-accent: #2c6fb8;
      --app-accent-soft: rgba(44, 111, 184, 0.14);
      --app-focus: #2c6fb8;

      --app-shadow-soft: 0 12px 30px rgba(20, 27, 36, 0.08);
      --app-shadow-card: 0 18px 45px rgba(20, 27, 36, 0.12);
      --app-shadow-rail: 0 20px 50px rgba(20, 27, 36, 0.08);
    }

    body.theme-dark {
      --app-background: #0c1118;
      --app-rail: #151c26;
      --app-surface: #121822;
      --app-surface-muted: #0f151f;
      --app-card: #171f2b;
      --app-border: #253042;
      --app-text: #eef2f7;
      --app-muted: #9aa7b6;
      --app-accent: #6ea4e2;
      --app-accent-soft: rgba(110, 164, 226, 0.16);
      --app-focus: #6ea4e2;

      --app-shadow-soft: 0 14px 40px rgba(6, 10, 15, 0.35);
      --app-shadow-card: 0 22px 55px rgba(6, 10, 15, 0.45);
      --app-shadow-rail: 0 24px 60px rgba(6, 10, 15, 0.4);
    }

    body.theme-mountain {
      --app-background: linear-gradient(135deg, #f4efe5 0%, #f7f9fb 45%, #eef2f6 100%);
      --app-rail: rgba(255, 255, 255, 0.94);
      --app-surface: #ffffff;
      --app-surface-muted: #f3f4f1;
      --app-card: #ffffff;
      --app-border: #e2e4e1;
      --app-text: #1c2228;
      --app-muted: #5f6a73;
      --app-accent: #5b6f83;
      --app-accent-soft: rgba(91, 111, 131, 0.18);
      --app-focus: #5b6f83;

      --app-shadow-soft: 0 14px 40px rgba(78, 63, 50, 0.12);
      --app-shadow-card: 0 20px 50px rgba(78, 63, 50, 0.16);
      --app-shadow-rail: 0 26px 64px rgba(78, 63, 50, 0.16);
    }

    body.theme-mountain-dark {
      --app-background: linear-gradient(130deg, #0d1118 0%, #131c27 55%, #1b2634 100%);
      --app-rail: rgba(17, 23, 33, 0.96);
      --app-surface: #111824;
      --app-surface-muted: #0c131e;
      --app-card: #161f2c;
      --app-border: #263245;
      --app-text: #ecf0f4;
      --app-muted: #9aa7b6;
      --app-accent: #8ba6c1;
      --app-accent-soft: rgba(139, 166, 193, 0.2);
      --app-focus: #8ba6c1;

      --app-shadow-soft: 0 18px 48px rgba(4, 8, 14, 0.5);
      --app-shadow-card: 0 26px 65px rgba(4, 8, 14, 0.55);
      --app-shadow-rail: 0 28px 72px rgba(4, 8, 14, 0.5);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: var(--font-sans);
      background: var(--app-background);
      color: var(--app-text);
      min-height: 100vh;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    a:focus,
    button:focus,
    input:focus,
    textarea:focus {
      outline: 2px solid var(--app-focus);
      outline-offset: 2px;
    }

    .skip-link {
      position: absolute;
      left: 16px;
      top: -50px;
      background: var(--app-card);
      color: var(--app-text);
      border: 1px solid var(--app-border);
      padding: 8px 12px;
      border-radius: 8px;
      box-shadow: var(--app-shadow-soft);
      z-index: 10;
    }

    .skip-link:focus {
      top: 16px;
    }

    .case-workspace {
      min-height: 100vh;
      display: grid;
      grid-template-columns: 280px minmax(0, 1fr) 340px;
      gap: 24px;
      padding: 24px;
    }

    .case-rail {
      background: var(--app-rail);
      border: 1px solid var(--app-border);
      border-radius: 18px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      box-shadow: var(--app-shadow-rail);
    }

    .case-rail-header {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .case-rail-logo {
      font-family: var(--font-serif);
      font-size: 1.4rem;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .case-rail-note {
      font-size: 0.9rem;
      color: var(--app-muted);
    }

    .case-rail-filters h2 {
      font-size: 1rem;
      margin-bottom: 10px;
    }

    .case-rail-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }

    .case-rail-tabs button {
      border: 1px solid var(--app-border);
      background: var(--app-surface);
      color: var(--app-text);
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .case-rail-tabs button[aria-selected="true"] {
      background: var(--app-accent-soft);
      border-color: var(--app-accent);
      color: var(--app-text);
    }

    .case-rail-filters label {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 6px;
      color: var(--app-muted);
    }

    .case-rail-filters input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--app-border);
      background: var(--app-surface);
      color: var(--app-text);
    }

    .case-rail-list ul {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin: 0;
      padding: 0;
    }

    .case-card {
      width: 100%;
      border: 1px solid var(--app-border);
      background: var(--app-surface);
      border-radius: 14px;
      padding: 12px 14px;
      text-align: left;
      display: grid;
      gap: 6px;
      cursor: pointer;
      position: relative;
      box-shadow: var(--app-shadow-soft);
    }

    .case-card[aria-current="true"] {
      border-color: var(--app-accent);
      box-shadow: var(--app-shadow-card);
    }

    .case-title {
      font-weight: 600;
    }

    .case-meta,
    .case-preview {
      font-size: 0.85rem;
      color: var(--app-muted);
    }

    .case-unread {
      position: absolute;
      top: 12px;
      right: 12px;
      background: var(--app-accent);
      color: var(--app-surface);
      min-width: 22px;
      height: 22px;
      border-radius: 999px;
      display: grid;
      place-items: center;
      font-size: 0.75rem;
    }

    .case-thread {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .case-thread-header {
      background: var(--app-surface);
      border: 1px solid var(--app-border);
      border-radius: 18px;
      padding: 18px 20px;
      box-shadow: var(--app-shadow-soft);
    }

    .case-thread-header h1 {
      font-size: 1.6rem;
      font-family: var(--font-serif);
    }

    .case-thread-title {
      font-weight: 600;
      margin-top: 6px;
    }

    .case-thread-subtitle,
    .case-thread-note {
      font-size: 0.9rem;
      color: var(--app-muted);
      margin-top: 4px;
    }

    .case-participants,
    .message-history,
    .message-composer {
      background: var(--app-surface);
      border: 1px solid var(--app-border);
      border-radius: 18px;
      padding: 18px 20px;
      box-shadow: var(--app-shadow-soft);
    }

    .message-history {
      background: var(--app-surface-muted);
      display: flex;
      flex-direction: column;
      gap: 12px;
      height: clamp(360px, 55vh, 620px);
    }

    .message-scroll {
      flex: 1;
      overflow-y: auto;
      padding: 4px 2px 2px;
    }

    .case-participants h2,
    .message-history h2,
    .message-composer h2 {
      font-size: 1.1rem;
      margin-bottom: 10px;
    }

    .case-participants ul {
      list-style: none;
      display: grid;
      gap: 6px;
      color: var(--app-muted);
      margin: 0;
      padding: 0;
    }

    .message-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin: 0;
      padding: 0;
    }

    .thread-card {
      background: var(--app-card);
      border: 1px solid var(--app-border);
      border-radius: 18px;
      padding: 18px;
      box-shadow: var(--app-shadow-card);
      display: grid;
      gap: 12px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 12px;
    }

    .card-header h3 {
      font-size: 1rem;
      margin-bottom: 4px;
    }

    .card-role {
      font-size: 0.85rem;
      color: var(--app-muted);
    }

    .card-body p {
      line-height: 1.6;
    }

    .document-card {
      border-left: 4px solid var(--app-accent);
    }

    .document-card dl {
      display: grid;
      gap: 8px;
      font-size: 0.9rem;
    }

    .document-card dt {
      color: var(--app-muted);
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .document-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .document-actions button {
      border: 1px solid var(--app-border);
      background: var(--app-surface-muted);
      color: var(--app-text);
      padding: 6px 12px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .document-actions a {
      border: 1px solid var(--app-border);
      background: var(--app-surface-muted);
      color: var(--app-text);
      padding: 6px 12px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.85rem;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .document-comments {
      border-top: 1px solid var(--app-border);
      padding-top: 12px;
      display: grid;
      gap: 12px;
    }

    .document-comments h4 {
      font-size: 0.95rem;
    }

    .document-comments ol {
      list-style: none;
      display: grid;
      gap: 10px;
      margin: 0;
      padding: 0;
    }

    .document-comments article {
      background: var(--app-surface-muted);
      border-radius: 12px;
      padding: 10px 12px;
      border: 1px solid var(--app-border);
    }

    .document-comments h5 {
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .message-composer form,
    .document-upload form,
    .document-comments form {
      display: grid;
      gap: 10px;
    }

    .message-composer textarea,
    .document-upload textarea,
    .document-comments textarea {
      width: 100%;
      border: 1px solid var(--app-border);
      border-radius: 12px;
      padding: 10px 12px;
      background: var(--app-surface);
      color: var(--app-text);
      font-family: var(--font-sans);
    }

    .message-composer input,
    .document-upload input,
    .document-comments input {
      border: 1px solid var(--app-border);
      border-radius: 10px;
      padding: 8px 10px;
      background: var(--app-surface);
      color: var(--app-text);
      font-family: var(--font-sans);
    }

    .composer-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .message-composer.is-dragover {
      border-color: var(--app-accent);
      box-shadow: var(--app-shadow-card);
    }

    .composer-attachments {
      border: 1px dashed var(--app-border);
      border-radius: 12px;
      padding: 10px 12px;
      background: var(--app-surface-muted);
      display: grid;
      gap: 8px;
    }

    .composer-attachments[hidden] {
      display: none;
    }

    .attachment-item {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      font-size: 0.9rem;
    }

    .attachment-name {
      font-weight: 600;
    }

    .attachment-meta {
      color: var(--app-muted);
      font-size: 0.85rem;
    }

    .attachment-progress {
      width: 100%;
      height: 8px;
    }

    .attachment-actions {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .attachment-error {
      color: var(--app-muted);
      font-size: 0.8rem;
      margin-top: 4px;
    }

    .attachment-remove {
      border: 1px solid var(--app-border);
      background: var(--app-surface);
      color: var(--app-text);
      padding: 4px 10px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 0.8rem;
    }

    button[type="submit"] {
      background: var(--app-accent);
      color: var(--app-surface);
      border: none;
      border-radius: 10px;
      padding: 8px 14px;
      cursor: pointer;
      font-weight: 600;
    }

    .case-overview-panel {
      background: var(--app-surface);
      border: 1px solid var(--app-border);
      border-radius: 18px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      box-shadow: var(--app-shadow-rail);
    }

    .case-overview-panel h2 {
      font-size: 1.3rem;
      font-family: var(--font-serif);
    }

    .case-overview-panel h3 {
      font-size: 1rem;
      margin-bottom: 8px;
    }

    .case-overview-panel dl,
    .case-overview-panel ul {
      display: grid;
      gap: 8px;
      list-style: none;
      font-size: 0.9rem;
      color: var(--app-muted);
      margin: 0;
      padding: 0;
    }

    .case-overview-panel a {
      color: var(--app-accent);
      font-weight: 600;
    }

    @media (max-width: 1200px) {
      .case-workspace {
        grid-template-columns: 240px minmax(0, 1fr);
      }

      .case-overview-panel {
        grid-column: 1 / -1;
      }
    }

    @media (max-width: 900px) {
      .case-workspace {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <a href="#case-messages" class="skip-link">Skip to case messages</a>

  <div class="case-workspace" role="presentation">
    <aside class="case-rail" aria-label="Case switcher">
      <header class="case-rail-header">
        <a href="case-dashboard.html" class="case-rail-logo">Let's-ParaConnect</a>
        <p class="case-rail-note">Shared workspace for attorneys and paralegals.</p>
      </header>

      <section class="case-rail-filters" aria-label="Case filters">
        <h2>Cases</h2>
        <div class="case-rail-tabs" role="tablist" aria-label="Case view">
          <button type="button" role="tab" aria-selected="true">Active</button>
          <button type="button" role="tab" aria-selected="false">Unread</button>
        </div>
        <label for="case-search">Search cases</label>
        <input id="case-search" name="case-search" type="search" placeholder="Search by client or matter" />
      </section>

      <nav class="case-rail-list" aria-label="Active cases">
        <p id="caseListStatus" class="case-rail-note">Loading cases...</p>
        <ul id="caseList"></ul>
      </nav>
    </aside>

    <main id="case-messages" class="case-thread" aria-label="Case conversation" data-case-id="">
      <header class="case-thread-header">
        <h1>Messages</h1>
        <p class="case-thread-title" id="caseTitle">Select a case</p>
        <p class="case-thread-subtitle" id="caseStatusLine">Waiting for case selection.</p>
        <p class="case-thread-note">Lucid-style message cards support collaborative reading, drafting, and review.</p>
      </header>

      <section class="case-participants" aria-label="Participants">
        <h2>Participants</h2>
        <ul id="caseParticipants"></ul>
      </section>

      <section class="message-history" aria-label="Conversation">
        <h2>Conversation</h2>
        <div class="message-scroll" role="region" aria-label="Conversation thread">
          <ol class="message-list" id="caseMessageList" data-case-id=""></ol>
        </div>
      </section>

      <section class="message-composer" aria-label="Write a message">
        <h2>New message</h2>
        <form id="caseMessageForm">
          <label for="caseMessageInput">Message</label>
          <textarea id="caseMessageInput" name="message-body" rows="4" placeholder="Write your message"></textarea>
          <div class="composer-actions">
            <label for="message-attachment">Attach a file</label>
            <input id="message-attachment" name="message-attachment" type="file" multiple />
            <button type="submit">Send</button>
          </div>
          <div id="caseAttachmentStaging" class="composer-attachments" aria-live="polite" hidden></div>
          <p id="caseMessageStatus" class="case-thread-subtitle" role="status" aria-live="polite"></p>
        </form>
      </section>
    </main>

    <aside class="case-overview-panel" aria-label="Case overview">
      <header>
        <h2>Case overview</h2>
      </header>

      <section class="case-overview-escrow">
        <h3>Escrow</h3>
        <dl>
          <div>
            <dt>Amount</dt>
            <dd id="caseEscrowAmount">-</dd>
          </div>
          <div>
            <dt>Status</dt>
            <dd id="caseEscrowStatus">-</dd>
          </div>
        </dl>
      </section>

      <section class="case-overview-hire">
        <h3>Hire details</h3>
        <dl>
          <div>
            <dt>Hire date</dt>
            <dd id="caseHireDate">-</dd>
          </div>
          <div>
            <dt>Matter type</dt>
            <dd id="caseMatterType">-</dd>
          </div>
        </dl>
      </section>

      <section class="case-overview-deadlines">
        <h3>Deadlines</h3>
        <ul id="caseDeadlineList"></ul>
      </section>

      <section class="case-overview-summary">
        <h3>Case summary</h3>
        <p id="caseSummary">-</p>
      </section>

      <section class="case-overview-tasks">
        <h3>Tasks</h3>
        <ul id="caseTaskList"></ul>
      </section>

      <section class="case-overview-meeting">
        <h3>Zoom link</h3>
        <a id="caseZoomLink" href="#" target="_blank" rel="noopener">Join scheduled Zoom</a>
      </section>
    </aside>
  </div>
  <script type="module" src="assets/scripts/case-detail.js"></script>
</body>
</html>
