<!DOCTYPE html>
<html lang="en">
<head>

  <link rel="stylesheet" href="assets/styles/fonts.css" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="theme-color" content="#0B2A4A">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Case Dashboard – Let’s-ParaConnect</title>
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
  <link rel="icon" href="/favicon.ico" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="manifest" href="site.webmanifest" />
  <link rel="mask-icon" href="maskable-icon.png" color="#0B2A4A" />

  <script src="assets/scripts/utils/session.js"></script>
  <style>
    .skip-link {
      position: absolute;
      left: 12px;
      top: -40px;
      background: #1a2230;
      color: #ffffff;
      padding: 8px 12px;
      border-radius: 6px;
      text-decoration: none;
      z-index: 10000;
      font-size: 14px;
    }

    .skip-link:focus {
      top: 12px;
    }

    .gold{color:#b4975a;}
    :root {
      --bg:#ffffff;
      --sidebar-bg:#f5f5f5e6;
      --panel:#fcfcfc;
      --accent:#b6a47a;
      --ink:#1a1a1a;
      --muted:#8a8a8a;
      --line:rgba(0,0,0,0.08);
      --radius:14px;
      --font-serif:'Cormorant Garamond',serif;
      --font-sans:'Sarabun',sans-serif;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{display:flex;font-family:var(--font-sans);color:var(--ink);background:var(--bg);min-height:100vh;}

    .sidebar{width:240px;background:var(--sidebar-bg);display:flex;flex-direction:column;border-right:1px solid var(--line);padding:24px 16px;}
    .logo{font-family:var(--font-serif);font-size:1.6rem;font-weight:300;letter-spacing:.5px;margin-bottom:36px;text-align:center;}
    nav{display:flex;flex-direction:column;gap:14px;}
    nav a{text-decoration:none;color:var(--ink);font-weight:200;font-size:.95rem;padding:10px 14px;border-radius:var(--radius);transition:background .3s ease;}
    nav a.active,nav a:hover{background:rgba(0,0,0,0.04);}
    .sidebar-link{
      margin-top:1.5rem;
      width:100%;
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:0.6rem 1rem;
      background:transparent;
      font-size:0.9rem;
      font-family:var(--font-sans);
      cursor:pointer;
      transition:background .2s,color .2s;
    }
    .sidebar-link:hover,
    .sidebar-link:focus{
      background:rgba(0,0,0,0.05);
      color:var(--accent);
      outline:none;
    }
    .sidebar-bottom{margin-top:auto;display:flex;flex-direction:column;gap:12px;}
    .sidebar-footer{font-size:.7rem;color:var(--muted);text-align:center;}

    .main{flex:1;padding:40px;overflow-y:auto;background:var(--bg);}
    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;}
    .breadcrumbs{font-size:.9rem;color:var(--muted);}
    .top-actions{display:flex;align-items:center;gap:.75rem;}
    .btn{border:1px solid var(--line);border-radius:8px;padding:.55rem 1.1rem;background:#fff;font-size:.9rem;cursor:pointer;transition:background .2s;}
    .btn.primary{background:var(--accent);color:#fff;border-color:var(--accent);}
    .btn.primary:hover{background:#a08954;}
    .btn.icon{display:flex;align-items:center;gap:.4rem;}
    .ghost-btn{background:transparent;border:1px solid var(--line);border-radius:8px;padding:.45rem .8rem;font-size:1rem;cursor:pointer;}

    .menu-container{position:relative;}
    .menu-trigger{background:transparent;border:none;font-size:1.3rem;cursor:pointer;padding:.25rem .5rem;border-radius:6px;transition:background .2s;}
    .menu-trigger:hover{background:rgba(0,0,0,0.05);}
    .menu-dropdown{display:none;position:absolute;right:0;top:32px;background:#fff;border:1px solid var(--line);border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,0.12);width:180px;z-index:40;flex-direction:column;}
    .menu-dropdown button{background:none;border:none;text-align:left;padding:10px 14px;font-size:.9rem;cursor:pointer;color:var(--ink);transition:background .2s;}
    .menu-dropdown button:hover{background:rgba(0,0,0,0.05);}
    .menu-dropdown hr{border:none;border-top:1px solid var(--line);margin:.35rem 0;}
    .menu-dropdown .delete{color:#c9302c;}
    .menu-container.active .menu-dropdown{display:flex;}

    header h1{font-family:var(--font-serif);font-weight:300;font-size:2.1rem;margin-bottom:.25rem;}
    header p{color:var(--muted);font-size:.95rem;margin-bottom:1rem;}

    .layout{display:grid;grid-template-columns:260px 1fr;gap:2rem;}
    .clients-panel{border:1px solid var(--line);border-radius:var(--radius);background:var(--panel);padding:1rem;height:min(760px,calc(100vh - 160px));overflow-y:auto;}
    .clients-panel h2{font-family:var(--font-serif);font-size:1.3rem;margin-bottom:.6rem;}
    .client-search{width:100%;padding:.5rem .75rem;border:1px solid var(--line);border-radius:8px;margin-bottom:.9rem;}
    .client-item{padding:.55rem .4rem;border-radius:8px;display:flex;justify-content:space-between;align-items:center;font-size:.9rem;cursor:pointer;transition:background .2s;}
    .client-item:hover,.client-item.active{background:rgba(182,164,122,0.15);}
    .client-item span{color:var(--muted);font-size:.85rem;}

    .case-content{border:1px solid var(--line);border-radius:var(--radius);background:#fff;padding:1.5rem;}
    .tabs{display:flex;gap:.6rem;flex-wrap:wrap;margin-bottom:1.2rem;border-bottom:1px solid var(--line);padding-bottom:.6rem;position:sticky;top:0;background:#fff;}
    .tab-btn{background:#f7f7f7;border:1px solid var(--line);border-radius:20px;padding:.4rem 1rem;font-size:.85rem;cursor:pointer;transition:all .2s;}
    .tab-btn.active{background:var(--accent);color:#fff;border-color:var(--accent);}

    .metrics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem;margin-bottom:1.5rem;}
    .metric-card{border:1px solid var(--line);border-radius:12px;padding:1rem;background:var(--panel);}
    .metric-card h3{font-family:var(--font-serif);font-weight:300;font-size:1rem;margin-bottom:.35rem;}
    .metric-card p{font-size:1.3rem;font-weight:300;}

    .info-columns{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;}
    .info-card{border:1px solid var(--line);border-radius:12px;padding:1.1rem;background:#fff;}
    .info-card h4{font-family:var(--font-serif);margin-bottom:.4rem;font-size:1rem;}
    .info-list{list-style:none;padding:0;margin:0;}
    .info-list li{display:flex;justify-content:space-between;margin-bottom:.35rem;font-size:.9rem;color:var(--muted);}
    .info-list li span{color:var(--ink);}

    @media(max-width:980px){
      .layout{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>
  <a class="skip-link" href="#main">Skip to main content</a>
  <aside class="sidebar">
    <div class="logo">Dashboard</div>
    <nav>
      <a href="dashboard-attorney.html">Home</a>
      <a href="dashboard-attorney.html#cases" class="active">Cases &amp; Files</a>
      <a href="dashboard-attorney.html#billing">Escrow</a>
      <a href="help.html">Help</a>
    </nav>
    <div class="sidebar-bottom">
      <button type="button" class="sidebar-link" id="logoutBtn">Log Out</button>
      <div class="sidebar-footer"><a href="index.html" style="color:inherit;text-decoration:none;">© Let’s-ParaConnect 2026</a></div>
    </div>
  </aside>

  <main id="main" tabindex="-1" class="main">
    <div class="topbar">
      <div class="breadcrumbs">Clients / Case Dashboard</div>
      <div class="top-actions">
        <button class="ghost-btn" type="button" onclick="downloadSummary()" aria-label="Download summary">⭳</button>
        <button class="btn primary" onclick="createCase()">+ Case (Project)</button>
        <div class="menu-container">
          <button class="menu-trigger" type="button" aria-label="Open actions menu" aria-haspopup="menu" aria-expanded="false" aria-controls="caseDashboardMenu">⋯</button>
          <div class="menu-dropdown" id="caseDashboardMenu">
            <button onclick="shareDashboard()">Share</button>
            <button onclick="renameDashboard()">Rename</button>
            <button onclick="moveDashboard()">Move to Case</button>
            <hr>
            <button onclick="archiveDashboard()">Archive</button>
            <button class="delete" onclick="deleteDashboard()">Delete</button>
          </div>
        </div>
      </div>
    </div>

    <header>
      <h1>Case Dashboard</h1>
      <p>Monitor client health, trust balances, and open projects from a single view.</p>
    </header>

    <div class="layout">
      <section class="clients-panel">
        <h2>Clients</h2>
        <input class="client-search" id="clientSearch" type="search" placeholder="Search clients" aria-label="Search clients" />
        <div id="clientList"></div>
      </section>

      <section class="case-content">
        <div class="tabs" id="tabBar">
          <button class="tab-btn active" data-tab="summary">Summary</button>
          <button class="tab-btn" data-tab="cases">Cases / Projects</button>
          <button class="tab-btn" data-tab="invoices" onclick="window.location.href='case-invoices.html'">Invoices</button>
          <button class="tab-btn" data-tab="payments">Payments</button>
          <button class="tab-btn" data-tab="trust">Trust Transactions</button>
          <button class="tab-btn" data-tab="settings">Settings</button>
        </div>

        <div id="summaryTab">
          <div class="metrics-grid" id="metricsGrid"></div>
          <div class="info-columns">
            <div class="info-card">
              <h4>Fees & Expenses</h4>
              <ul class="info-list" id="feeList"></ul>
            </div>
            <div class="info-card">
              <h4>Billing Info</h4>
              <ul class="info-list" id="billingList"></ul>
            </div>
            <div class="info-card">
              <h4>Billed / Invoices</h4>
              <ul class="info-list" id="invoiceList"></ul>
            </div>
            <div class="info-card">
              <h4>Primary Contact</h4>
              <ul class="info-list" id="contactList"></ul>
            </div>
          </div>
        </div>

        <div id="placeholderTab" class="hidden" style="color:var(--muted);font-size:.95rem;">Tab content loading...</div>
      </section>
    </div>
  </main>

  <script type="module" src="assets/scripts/auth.js"></script>
  <script>
    const clients=[
      { name:'Smith & Co.', cases:3, trust:'$1,050.00' },
      { name:'Anderson Merger', cases:2, trust:'$250.00' },
      { name:'Hamilton & Ross', cases:4, trust:'$0.00' },
      { name:'Brightpath LLC', cases:1, trust:'$4,100.00' }
    ];

    const metrics=[
      { label:'Active Cases', value:4 },
      { label:'Closed Cases', value:0 },
      { label:'Trust Balance', value:'$1,300.00' },
      { label:'Account Receivable', value:'$13,215.00' }
    ];

    const feeData=[
      { label:'Open Fee Items', value:'$2,450.00' },
      { label:'Unbilled Expenses', value:'$315.00' }
    ];
    const billingData=[
      { label:'Billing Frequency', value:'Monthly' },
      { label:'Preferred Format', value:'PDF & Portal' }
    ];
    const invoiceData=[
      { label:'Outstanding Invoices', value:'$3,800.00' },
      { label:'Average Days to Pay', value:'21 days' }
    ];
    const contactData=[
      { label:'Contact', value:'Avery Brooks' },
      { label:'Email', value:'avery@smithco.com' },
      { label:'Phone', value:'(415) 555-0100' }
    ];

    const clientList=document.getElementById('clientList');
    function renderClients(filter=''){
      clientList.innerHTML='';
      clients.filter(c=>c.name.toLowerCase().includes(filter.toLowerCase()))
        .forEach((client,idx)=>{
          const div=document.createElement('div');
          div.className='client-item'+(idx===0?' active':'');
          div.innerHTML=`<div>${client.name}<span>${client.trust}</span></div><span>${client.cases} cases</span>`;
          div.addEventListener('click',()=>{
            document.querySelectorAll('.client-item').forEach(i=>i.classList.remove('active'));
            div.classList.add('active');
            alert(`Switched focus to ${client.name}`);
          });
          clientList.appendChild(div);
        });
    }
    document.getElementById('clientSearch').addEventListener('input',e=>renderClients(e.target.value));

    const metricsGrid=document.getElementById('metricsGrid');
    metrics.forEach(m=>{
      const card=document.createElement('div');
      card.className='metric-card';
      card.innerHTML=`<h3>${m.label}</h3><p>${m.value}</p>`;
      metricsGrid.appendChild(card);
    });

    function renderList(listEl,data){
      listEl.innerHTML='';
      data.forEach(item=>{
        const li=document.createElement('li');
        li.innerHTML=`${item.label}<span>${item.value}</span>`;
        listEl.appendChild(li);
      });
    }
    renderList(document.getElementById('feeList'),feeData);
    renderList(document.getElementById('billingList'),billingData);
    renderList(document.getElementById('invoiceList'),invoiceData);
    renderList(document.getElementById('contactList'),contactData);

    renderClients();

    document.getElementById('tabBar').addEventListener('click',e=>{
      if(!e.target.classList.contains('tab-btn')) return;
      const tab=e.target.dataset.tab;
      document.querySelectorAll('.tab-btn').forEach(btn=>btn.classList.remove('active'));
      e.target.classList.add('active');
      if(tab==='summary'){
        document.getElementById('summaryTab').classList.remove('hidden');
        document.getElementById('placeholderTab').classList.add('hidden');
      } else if(tab==='invoices') {
        return; // handled via href
      } else {
        document.getElementById('summaryTab').classList.add('hidden');
        const text=tab.charAt(0).toUpperCase()+tab.slice(1);
        document.getElementById('placeholderTab').textContent=`${text} tools are coming soon.`;
        document.getElementById('placeholderTab').classList.remove('hidden');
      }
    });

    const menuContainers = document.querySelectorAll('.menu-container');
    let menuTriggerFocus = null;

    function closeMenus({ returnFocus = false } = {}) {
      menuContainers.forEach((container) => {
        container.classList.remove('active');
        const trigger = container.querySelector('.menu-trigger');
        if (trigger) trigger.setAttribute('aria-expanded', 'false');
      });
      if (returnFocus && menuTriggerFocus) {
        menuTriggerFocus.focus();
      }
      if (!returnFocus) menuTriggerFocus = null;
    }

    document.addEventListener('click', (e) => {
      let handled = false;
      menuContainers.forEach((container) => {
        if (!container.contains(e.target)) return;
        handled = true;
        const willOpen = !container.classList.contains('active');
        closeMenus();
        if (willOpen) {
          container.classList.add('active');
          const trigger = container.querySelector('.menu-trigger');
          if (trigger) {
            trigger.setAttribute('aria-expanded', 'true');
            menuTriggerFocus = trigger;
          }
        }
      });
      if (!handled) closeMenus();
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeMenus({ returnFocus: true });
      }
    });

    function shareDashboard(){alert('Share link copied.');}
    function renameDashboard(){const name=prompt('Rename dashboard','Smith & Co. Dashboard');if(name)alert(`Dashboard renamed to ${name}.`);}
    function moveDashboard(){alert('Move to Case flow coming soon.');}
    function archiveDashboard(){alert('Dashboard archived.');}
    function deleteDashboard(){if(confirm('Delete this dashboard?'))alert('Dashboard deleted.');}
    function createCase(){alert('Launching new case wizard...');}
    function downloadSummary(){alert('Downloading dashboard summary.');}
  </script>

  <script>
    window.checkSession('paralegal');
  </script>
</body>
</html>
