<!DOCTYPE html>
<html lang="en">
<head>
  <style>body{opacity:1!important;visibility:visible!important}</style>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login | Lets-ParaConnect</title>

  <!-- Global styles -->
  <link rel="stylesheet" href="assets/styles.css" />

  <!-- Page polish -->
  <style>
    :root { --brand-brown:#8c7864; --bg-cream:#f5f2ed; --text-dark:#5c4e3a; --navy:#27394d; --line:#e8edf3; }
    body{
      font-family: Georgia, serif; background: var(--bg-cream);
      min-height:100vh; margin:0; display:grid; place-items:center;
    }
    .login-card{
      width:min(440px, 92vw); background:#fff; border:1px solid var(--line);
      border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,.08); padding:22px;
    }
    h1{ color:var(--navy); margin:0 0 12px; font-weight:700; font-size:1.35rem; text-align:center; }

    .form-group{ margin:10px 0; }
    label{ display:block; margin:0 0 6px; font-weight:600; color:#334155; }
    input{
      width:100%; padding:.7rem .8rem; border:1px solid #d9dee5; border-radius:8px; font-size:1rem;
      outline:none; transition:border-color .15s, box-shadow .15s; background:#fff;
    }
    input:focus{ border-color:var(--brand-brown); box-shadow:0 0 0 3px rgba(140,120,100,.14); }

  .pw-wrap{ position:relative; }
  /* Give the input room so the Show/Hide button doesn’t overlap text/caret */
  .pw-wrap input{ padding-right:4.5rem; }

  .show-toggle{
    position:absolute; right:.6rem; top:50%; transform:translateY(-50%);
    background:transparent; border:0; font:inherit; font-weight:600;
    color:var(--text-dark); cursor:pointer; padding:.2rem .35rem; border-radius:6px;
  }
  .show-toggle:focus{ outline:2px solid rgba(39,57,77,.45); outline-offset:2px; }

    .login-btn{
      width:100%; margin-top:.5rem; background:var(--navy); color:#fff; border:0; padding:.78rem;
      border-radius:10px; cursor:pointer; font-weight:700;
    }
    .login-btn[disabled]{ opacity:.7; cursor:progress; }

    .msg{ margin-top:.75rem; min-height:1.2em; color:#7a5e25; }
    .muted{ color:#64748b; font-size:.9rem; text-align:center; }
  </style>

  <!-- CSRF bootstrap + role UI helpers (adds body.loaded, fetches /api/csrf) -->
  <script type="module" src="assets/scripts/auth.js"></script>
</head>
<body>
  <main class="login-card" aria-labelledby="loginTitle">
    <h1 id="loginTitle">Login to Lets-ParaConnect</h1>

    <form id="loginForm" novalidate>
      <div class="form-group">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" inputmode="email" autocomplete="email"
               placeholder="you@example.com" required aria-required="true" />
      </div>

      <div class="form-group pw-wrap">
        <label for="password">Password</label>
        <input id="password" name="password" type="password" autocomplete="current-password"
               placeholder="••••••••" required aria-required="true" />
        <button type="button" class="show-toggle" aria-controls="password" aria-label="Show or hide password"
                onclick="window.togglePassword?.()">Show</button>
      </div>

      <button type="submit" class="login-btn">Login</button>
      <div id="msg" class="msg" role="status" aria-live="polite"></div>

      <p class="muted" style="margin-top:12px">
        Just previewing?
        <a href="#" id="devBypass">Dev bypass</a>
      </p>
    </form>
  </main>

  <!-- Page logic: uses your cookie-auth flow (/api/auth/login) with CSRF + redirects -->
  <script type="module" src="assets/scripts/login.js"></script>
  <script>
  // Accessible Show/Hide password toggle
  window.togglePassword = function () {
    const input = document.getElementById('password');
    const btn   = document.querySelector('.show-toggle');
    const isHidden = input.type === 'password';

    input.type = isHidden ? 'text' : 'password';
    btn.textContent = isHidden ? 'Hide' : 'Show';
    btn.setAttribute('aria-label', isHidden ? 'Hide password' : 'Show password');
    btn.setAttribute('aria-pressed', String(isHidden));

    // keep focus/caret in place
    input.focus({ preventScroll: true });
    const end = input.value.length;
    try { input.setSelectionRange(end, end); } catch {}
  };
</script>
</body>
</html>
